# سیستم آپدیت خودکار

## 📋 توضیحات
این سیستم به صورت خودکار نسخه‌های جدید برنامه را از GitHub بررسی کرده و در صورت وجود آپدیت، آن را دانلود و نصب می‌کند.

## 🔧 نحوه کارکرد

### 1. بررسی خودکار
- هر بار که برنامه باز می‌شود، سیستم آپدیت خودکار اجرا می‌شود
- نسخه فعلی برنامه با آخرین نسخه موجود در GitHub مقایسه می‌شود
- در صورت وجود نسخه جدیدتر، پیام آپدیت نمایش داده می‌شود

### 2. آپدیت دستی
- از منوی اصلی می‌توانید گزینه "آپدیت" را انتخاب کنید
- این گزینه به صورت دستی بررسی آپدیت را انجام می‌دهد

## 📦 نحوه نصب آپدیت

### مرحله 1: دانلود
- فایل آپدیت از GitHub دانلود می‌شود
- فایل در پوشه موقت سیستم ذخیره می‌شود

### مرحله 2: استخراج
- فایل ZIP استخراج می‌شود
- فایل‌های جدید آماده نصب می‌شوند

### مرحله 3: نصب
- برنامه فعلی بسته می‌شود
- فایل‌های جدید جایگزین فایل‌های قدیمی می‌شوند
- برنامه مجدداً راه‌اندازی می‌شود

## ⚙️ تنظیمات

### URL های آپدیت
```csharp
private readonly string _updateUrl = "https://api.github.com/repos/gangstardev/accounting/releases/latest";
private readonly string _downloadUrl = "https://github.com/gangstardev/accounting/releases/latest/download/AccountingApp.zip";
```

### نسخه فعلی
نسخه فعلی از فایل Assembly برنامه خوانده می‌شود:
```csharp
var version = Assembly.GetExecutingAssembly().GetName().Version;
```

## 🚨 نکات مهم

### 1. دسترسی ادمین
- برای نصب آپدیت، دسترسی ادمین مورد نیاز است
- فایل batch با دسترسی ادمین اجرا می‌شود

### 2. بستن برنامه
- در حین نصب آپدیت، برنامه بسته می‌شود
- تمام فایل‌های باز باید ذخیره شوند

### 3. پشتیبان‌گیری
- توصیه می‌شود قبل از آپدیت، از دیتابیس پشتیبان تهیه کنید
- فایل‌های مهم را در جای امنی کپی کنید

## 🔍 عیب‌یابی

### مشکل در دانلود
- اتصال اینترنت را بررسی کنید
- فایروال را چک کنید
- URL های آپدیت را بررسی کنید

### مشکل در نصب
- دسترسی ادمین را بررسی کنید
- فایل‌های برنامه را از حالت Read-only خارج کنید
- آنتی‌ویروس را موقتاً غیرفعال کنید

### مشکل در راه‌اندازی
- فایل‌های .NET Framework را بررسی کنید
- فایل‌های DLL را چک کنید
- لاگ‌های خطا را بررسی کنید

## 📝 لاگ‌ها

خطاهای آپدیت در کنسول نمایش داده می‌شوند:
```
خطا در بررسی آپدیت: [پیام خطا]
```

## 🔄 نسخه‌گذاری

### فرمت نسخه
نسخه‌ها به فرمت `Major.Minor.Build.Revision` هستند:
- مثال: `1.0.0.0`

### مقایسه نسخه
```csharp
var current = Version.Parse(_currentVersion);
var latest = Version.Parse(latestVersion);
return latest > current;
```

## 📞 پشتیبانی

در صورت بروز مشکل:
1. لاگ‌های خطا را بررسی کنید
2. اتصال اینترنت را چک کنید
3. دسترسی‌های فایل را بررسی کنید
4. با تیم پشتیبانی تماس بگیرید

## 🔒 امنیت

- فایل‌های آپدیت از GitHub رسمی دانلود می‌شوند
- فایل‌های موقت پس از نصب پاک می‌شوند
- دسترسی‌های محدود برای نصب استفاده می‌شود 